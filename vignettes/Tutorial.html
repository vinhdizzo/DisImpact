<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Vinh Nguyen" />

<meta name="date" content="2020-08-13" />

<title>DisImpact Tutorial</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">DisImpact Tutorial</h1>
<h4 class="author">Vinh Nguyen</h4>
<h4 class="date">2020-08-13</h4>


<div id="TOC">
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#install-package">Install Package</a></li>
<li><a href="#load-packages">Load Packages</a></li>
<li><a href="#load-toy-student-equity-data">Load toy student equity data</a></li>
<li><a href="#percentage-point-gap-ppg-method">Percentage point gap (PPG) method</a></li>
<li><a href="#proportionality-index">Proportionality index</a></li>
<li><a href="#index">80% index</a></li>
<li><a href="#when-dealing-with-a-non-success-variable-like-drop-out-or-probation">When dealing with a non-success variable like drop-out or probation</a></li>
<li><a href="#transformations-on-the-fly">Transformations on the fly</a></li>
<li><a href="#calculate-di-for-many-variables-and-groups">Calculate DI for many variables and groups</a></li>
</ul>
</div>

<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>The <code>DisImpact</code> R package contains functions that help in determining disproportionate impact (DI) based on the following methodologies:</p>
<ol style="list-style-type: decimal">
<li><a href="https://www.cccco.edu/-/media/CCCCO-Website/About-Us/Divisions/Digital-Innovation-and-Infrastructure/Research/Files/PercentagePointGapMethod2017.ashx">percentage point gap</a> (PPG) method,</li>
<li><a href="https://www.cccco.edu/-/media/CCCCO-Website/Files/DII/guidelines-for-measuring-disproportionate-impact-in-equity-plans-tfa-ada.pdf">proportionality index</a> method (method #1 in reference), and</li>
<li><a href="https://www.cccco.edu/-/media/CCCCO-Website/Files/DII/guidelines-for-measuring-disproportionate-impact-in-equity-plans-tfa-ada.pdf">80% index</a> method (method #2 in reference).</li>
</ol>
</div>
<div id="install-package" class="section level2">
<h2>Install Package</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="co"># From CRAN (Official)</span></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="co">## install.packages(&#39;DisImpact&#39;)</span></a>
<a class="sourceLine" id="cb1-3" title="3"></a>
<a class="sourceLine" id="cb1-4" title="4"><span class="co"># From github (Development)</span></a>
<a class="sourceLine" id="cb1-5" title="5"><span class="co">## devtools::install_github(&#39;vinhdizzo/DisImpact&#39;)</span></a></code></pre></div>
</div>
<div id="load-packages" class="section level2">
<h2>Load Packages</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw">library</span>(DisImpact)</a>
<a class="sourceLine" id="cb2-2" title="2"><span class="kw">library</span>(dplyr) <span class="co"># Ease in manipulations with data frames</span></a></code></pre></div>
</div>
<div id="load-toy-student-equity-data" class="section level2">
<h2>Load toy student equity data</h2>
<p>To illustrate the functionality of the package, let’s load a toy data set:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="co"># Load fake data set</span></a>
<a class="sourceLine" id="cb3-2" title="2"><span class="kw">data</span>(student_equity)</a></code></pre></div>
<p>The toy data set can be summarized as follows:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="co"># Summarize toy data</span></a>
<a class="sourceLine" id="cb4-2" title="2"><span class="kw">dim</span>(student_equity)</a></code></pre></div>
<pre><code>## [1] 20000    11</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">dSumm &lt;-<span class="st"> </span>student_equity <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-2" title="2"><span class="st">  </span><span class="kw">group_by</span>(Cohort, Ethnicity) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-3" title="3"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">n=</span><span class="kw">n</span>(), <span class="dt">Transfer_Rate=</span><span class="kw">mean</span>(Transfer))</a>
<a class="sourceLine" id="cb6-4" title="4">dSumm <span class="co">## This is a summarized version of the data set</span></a></code></pre></div>
<pre><code>## # A tibble: 12 x 4
## # Groups:   Cohort [2]
##    Cohort Ethnicity           n Transfer_Rate
##     &lt;int&gt; &lt;chr&gt;           &lt;int&gt;         &lt;dbl&gt;
##  1   2017 Asian            3000         0.687
##  2   2017 Black            1000         0.31 
##  3   2017 Hispanic         2000         0.205
##  4   2017 Multi-Ethnicity   500         0.524
##  5   2017 Native American   100         0.43 
##  6   2017 White            3400         0.604
##  7   2018 Asian            3000         0.743
##  8   2018 Black            1000         0.297
##  9   2018 Hispanic         2000         0.218
## 10   2018 Multi-Ethnicity   500         0.484
## 11   2018 Native American   100         0.35 
## 12   2018 White            3400         0.631</code></pre>
</div>
<div id="percentage-point-gap-ppg-method" class="section level2">
<h2>Percentage point gap (PPG) method</h2>
<p><code>di_ppg</code> is the main work function, and it can take on vectors or column names the tidy way:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="co"># Vector</span></a>
<a class="sourceLine" id="cb8-2" title="2"><span class="kw">di_ppg</span>(<span class="dt">success=</span>student_equity<span class="op">$</span>Transfer, <span class="dt">group=</span>student_equity<span class="op">$</span>Ethnicity) <span class="op">%&gt;%</span><span class="st"> </span>as.data.frame</a></code></pre></div>
<pre><code>##             group    n success       pct reference reference_group
## 1           Asian 6000    4292 0.7153333    0.5264         overall
## 2           Black 2000     607 0.3035000    0.5264         overall
## 3        Hispanic 4000     847 0.2117500    0.5264         overall
## 4 Multi-Ethnicity 1000     504 0.5040000    0.5264         overall
## 5 Native American  200      78 0.3900000    0.5264         overall
## 6           White 6800    4200 0.6176471    0.5264         overall
##          moe    pct_lo    pct_hi di_indicator
## 1 0.03000000 0.6853333 0.7453333            0
## 2 0.03000000 0.2735000 0.3335000            1
## 3 0.03000000 0.1817500 0.2417500            1
## 4 0.03099032 0.4730097 0.5349903            0
## 5 0.06929646 0.3207035 0.4592965            1
## 6 0.03000000 0.5876471 0.6476471            0</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="co"># Tidy and column reference</span></a>
<a class="sourceLine" id="cb10-2" title="2"><span class="kw">di_ppg</span>(<span class="dt">success=</span>Transfer, <span class="dt">group=</span>Ethnicity, <span class="dt">data=</span>student_equity) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb10-3" title="3"><span class="st">  </span>as.data.frame</a></code></pre></div>
<pre><code>##             group    n success       pct reference reference_group
## 1           Asian 6000    4292 0.7153333    0.5264         overall
## 2           Black 2000     607 0.3035000    0.5264         overall
## 3        Hispanic 4000     847 0.2117500    0.5264         overall
## 4 Multi-Ethnicity 1000     504 0.5040000    0.5264         overall
## 5 Native American  200      78 0.3900000    0.5264         overall
## 6           White 6800    4200 0.6176471    0.5264         overall
##          moe    pct_lo    pct_hi di_indicator
## 1 0.03000000 0.6853333 0.7453333            0
## 2 0.03000000 0.2735000 0.3335000            1
## 3 0.03000000 0.1817500 0.2417500            1
## 4 0.03099032 0.4730097 0.5349903            0
## 5 0.06929646 0.3207035 0.4592965            1
## 6 0.03000000 0.5876471 0.6476471            0</code></pre>
<p>Sometimes, one might want to break out the DI calculation by cohort:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="co"># Cohort</span></a>
<a class="sourceLine" id="cb12-2" title="2"><span class="kw">di_ppg</span>(<span class="dt">success=</span>Transfer, <span class="dt">group=</span>Ethnicity, <span class="dt">cohort=</span>Cohort, <span class="dt">data=</span>student_equity) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-3" title="3"><span class="st">  </span>as.data.frame</a></code></pre></div>
<pre><code>##    cohort           group    n success       pct reference reference_group
## 1    2017           Asian 3000    2062 0.6873333    0.5140         overall
## 2    2017           Black 1000     310 0.3100000    0.5140         overall
## 3    2017        Hispanic 2000     410 0.2050000    0.5140         overall
## 4    2017 Multi-Ethnicity  500     262 0.5240000    0.5140         overall
## 5    2017 Native American  100      43 0.4300000    0.5140         overall
## 6    2017           White 3400    2053 0.6038235    0.5140         overall
## 7    2018           Asian 3000    2230 0.7433333    0.5388         overall
## 8    2018           Black 1000     297 0.2970000    0.5388         overall
## 9    2018        Hispanic 2000     437 0.2185000    0.5388         overall
## 10   2018 Multi-Ethnicity  500     242 0.4840000    0.5388         overall
## 11   2018 Native American  100      35 0.3500000    0.5388         overall
## 12   2018           White 3400    2147 0.6314706    0.5388         overall
##           moe    pct_lo    pct_hi di_indicator
## 1  0.03000000 0.6573333 0.7173333            0
## 2  0.03099032 0.2790097 0.3409903            1
## 3  0.03000000 0.1750000 0.2350000            1
## 4  0.04382693 0.4801731 0.5678269            0
## 5  0.09800000 0.3320000 0.5280000            0
## 6  0.03000000 0.5738235 0.6338235            0
## 7  0.03000000 0.7133333 0.7733333            0
## 8  0.03099032 0.2660097 0.3279903            1
## 9  0.03000000 0.1885000 0.2485000            1
## 10 0.04382693 0.4401731 0.5278269            1
## 11 0.09800000 0.2520000 0.4480000            1
## 12 0.03000000 0.6014706 0.6614706            0</code></pre>
<p><code>di_ppg</code> is also applicable to summarized data; just pass the counts to <code>success</code> and group size to <code>weight</code>. For example, we use the summarized data set, <code>dSumm</code>, and sample size <code>n</code>, in the following:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="kw">di_ppg</span>(<span class="dt">success=</span>Transfer_Rate<span class="op">*</span>n, <span class="dt">group=</span>Ethnicity, <span class="dt">cohort=</span>Cohort, <span class="dt">weight=</span>n, <span class="dt">data=</span>dSumm) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb14-2" title="2"><span class="st">  </span>as.data.frame</a></code></pre></div>
<pre><code>##    cohort           group    n success       pct reference reference_group
## 1    2017           Asian 3000    2062 0.6873333    0.5140         overall
## 2    2017           Black 1000     310 0.3100000    0.5140         overall
## 3    2017        Hispanic 2000     410 0.2050000    0.5140         overall
## 4    2017 Multi-Ethnicity  500     262 0.5240000    0.5140         overall
## 5    2017 Native American  100      43 0.4300000    0.5140         overall
## 6    2017           White 3400    2053 0.6038235    0.5140         overall
## 7    2018           Asian 3000    2230 0.7433333    0.5388         overall
## 8    2018           Black 1000     297 0.2970000    0.5388         overall
## 9    2018        Hispanic 2000     437 0.2185000    0.5388         overall
## 10   2018 Multi-Ethnicity  500     242 0.4840000    0.5388         overall
## 11   2018 Native American  100      35 0.3500000    0.5388         overall
## 12   2018           White 3400    2147 0.6314706    0.5388         overall
##           moe    pct_lo    pct_hi di_indicator
## 1  0.03000000 0.6573333 0.7173333            0
## 2  0.03099032 0.2790097 0.3409903            1
## 3  0.03000000 0.1750000 0.2350000            1
## 4  0.04382693 0.4801731 0.5678269            0
## 5  0.09800000 0.3320000 0.5280000            0
## 6  0.03000000 0.5738235 0.6338235            0
## 7  0.03000000 0.7133333 0.7733333            0
## 8  0.03099032 0.2660097 0.3279903            1
## 9  0.03000000 0.1885000 0.2485000            1
## 10 0.04382693 0.4401731 0.5278269            1
## 11 0.09800000 0.2520000 0.4480000            1
## 12 0.03000000 0.6014706 0.6614706            0</code></pre>
<p>By default, <code>di_ppg</code> uses the overall success rate as the reference rate for comparison (default: <code>reference=&#39;overall&#39;</code>). The <code>reference</code> argument also accepts <code>&#39;hpg&#39;</code> (highest performing group success rate as the reference rate), <code>&#39;all but current&#39;</code> (success rate of all groups combined excluding the comparison group), or a group value from <code>group</code>.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1"><span class="co"># Reference: Highest performing group</span></a>
<a class="sourceLine" id="cb16-2" title="2"><span class="kw">di_ppg</span>(<span class="dt">success=</span>Transfer, <span class="dt">group=</span>Ethnicity, <span class="dt">cohort=</span>Cohort, <span class="dt">reference=</span><span class="st">&#39;hpg&#39;</span>, <span class="dt">data=</span>student_equity) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb16-3" title="3"><span class="st">  </span>as.data.frame</a></code></pre></div>
<pre><code>##    cohort           group    n success       pct reference reference_group
## 1    2017           Asian 3000    2062 0.6873333 0.6873333             hpg
## 2    2017           Black 1000     310 0.3100000 0.6873333             hpg
## 3    2017        Hispanic 2000     410 0.2050000 0.6873333             hpg
## 4    2017 Multi-Ethnicity  500     262 0.5240000 0.6873333             hpg
## 5    2017 Native American  100      43 0.4300000 0.6873333             hpg
## 6    2017           White 3400    2053 0.6038235 0.6873333             hpg
## 7    2018           Asian 3000    2230 0.7433333 0.7433333             hpg
## 8    2018           Black 1000     297 0.2970000 0.7433333             hpg
## 9    2018        Hispanic 2000     437 0.2185000 0.7433333             hpg
## 10   2018 Multi-Ethnicity  500     242 0.4840000 0.7433333             hpg
## 11   2018 Native American  100      35 0.3500000 0.7433333             hpg
## 12   2018           White 3400    2147 0.6314706 0.7433333             hpg
##           moe    pct_lo    pct_hi di_indicator
## 1  0.03000000 0.6573333 0.7173333            0
## 2  0.03099032 0.2790097 0.3409903            1
## 3  0.03000000 0.1750000 0.2350000            1
## 4  0.04382693 0.4801731 0.5678269            1
## 5  0.09800000 0.3320000 0.5280000            1
## 6  0.03000000 0.5738235 0.6338235            1
## 7  0.03000000 0.7133333 0.7733333            0
## 8  0.03099032 0.2660097 0.3279903            1
## 9  0.03000000 0.1885000 0.2485000            1
## 10 0.04382693 0.4401731 0.5278269            1
## 11 0.09800000 0.2520000 0.4480000            1
## 12 0.03000000 0.6014706 0.6614706            1</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1"><span class="co"># Reference: All but current (PPG minus 1)</span></a>
<a class="sourceLine" id="cb18-2" title="2"><span class="kw">di_ppg</span>(<span class="dt">success=</span>Transfer, <span class="dt">group=</span>Ethnicity, <span class="dt">cohort=</span>Cohort, <span class="dt">reference=</span><span class="st">&#39;all but current&#39;</span>, <span class="dt">data=</span>student_equity) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb18-3" title="3"><span class="st">  </span>as.data.frame</a></code></pre></div>
<pre><code>##    cohort           group    n success       pct reference reference_group
## 1    2017           Asian 3000    2062 0.6873333 0.4397143 all but current
## 2    2017           Black 1000     310 0.3100000 0.5366667 all but current
## 3    2017        Hispanic 2000     410 0.2050000 0.5912500 all but current
## 4    2017 Multi-Ethnicity  500     262 0.5240000 0.5134737 all but current
## 5    2017 Native American  100      43 0.4300000 0.5148485 all but current
## 6    2017           White 3400    2053 0.6038235 0.4677273 all but current
## 7    2018           Asian 3000    2230 0.7433333 0.4511429 all but current
## 8    2018           Black 1000     297 0.2970000 0.5656667 all but current
## 9    2018        Hispanic 2000     437 0.2185000 0.6188750 all but current
## 10   2018 Multi-Ethnicity  500     242 0.4840000 0.5416842 all but current
## 11   2018 Native American  100      35 0.3500000 0.5407071 all but current
## 12   2018           White 3400    2147 0.6314706 0.4910606 all but current
##           moe    pct_lo    pct_hi di_indicator
## 1  0.03000000 0.6573333 0.7173333            0
## 2  0.03099032 0.2790097 0.3409903            1
## 3  0.03000000 0.1750000 0.2350000            1
## 4  0.04382693 0.4801731 0.5678269            0
## 5  0.09800000 0.3320000 0.5280000            0
## 6  0.03000000 0.5738235 0.6338235            0
## 7  0.03000000 0.7133333 0.7733333            0
## 8  0.03099032 0.2660097 0.3279903            1
## 9  0.03000000 0.1885000 0.2485000            1
## 10 0.04382693 0.4401731 0.5278269            1
## 11 0.09800000 0.2520000 0.4480000            1
## 12 0.03000000 0.6014706 0.6614706            0</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1"><span class="co"># Reference: custom group</span></a>
<a class="sourceLine" id="cb20-2" title="2"><span class="kw">di_ppg</span>(<span class="dt">success=</span>Transfer, <span class="dt">group=</span>Ethnicity, <span class="dt">cohort=</span>Cohort, <span class="dt">reference=</span><span class="st">&#39;White&#39;</span>, <span class="dt">data=</span>student_equity) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb20-3" title="3"><span class="st">  </span>as.data.frame</a></code></pre></div>
<pre><code>##    cohort           group    n success       pct reference reference_group
## 1    2017           Asian 3000    2062 0.6873333 0.6038235           White
## 2    2017           Black 1000     310 0.3100000 0.6038235           White
## 3    2017        Hispanic 2000     410 0.2050000 0.6038235           White
## 4    2017 Multi-Ethnicity  500     262 0.5240000 0.6038235           White
## 5    2017 Native American  100      43 0.4300000 0.6038235           White
## 6    2017           White 3400    2053 0.6038235 0.6038235           White
## 7    2018           Asian 3000    2230 0.7433333 0.6314706           White
## 8    2018           Black 1000     297 0.2970000 0.6314706           White
## 9    2018        Hispanic 2000     437 0.2185000 0.6314706           White
## 10   2018 Multi-Ethnicity  500     242 0.4840000 0.6314706           White
## 11   2018 Native American  100      35 0.3500000 0.6314706           White
## 12   2018           White 3400    2147 0.6314706 0.6314706           White
##           moe    pct_lo    pct_hi di_indicator
## 1  0.03000000 0.6573333 0.7173333            0
## 2  0.03099032 0.2790097 0.3409903            1
## 3  0.03000000 0.1750000 0.2350000            1
## 4  0.04382693 0.4801731 0.5678269            1
## 5  0.09800000 0.3320000 0.5280000            1
## 6  0.03000000 0.5738235 0.6338235            0
## 7  0.03000000 0.7133333 0.7733333            0
## 8  0.03099032 0.2660097 0.3279903            1
## 9  0.03000000 0.1885000 0.2485000            1
## 10 0.04382693 0.4401731 0.5278269            1
## 11 0.09800000 0.2520000 0.4480000            1
## 12 0.03000000 0.6014706 0.6614706            0</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1"><span class="kw">di_ppg</span>(<span class="dt">success=</span>Transfer, <span class="dt">group=</span>Ethnicity, <span class="dt">cohort=</span>Cohort, <span class="dt">reference=</span><span class="st">&#39;Asian&#39;</span>, <span class="dt">data=</span>student_equity) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb22-2" title="2"><span class="st">  </span>as.data.frame</a></code></pre></div>
<pre><code>##    cohort           group    n success       pct reference reference_group
## 1    2017           Asian 3000    2062 0.6873333 0.6873333           Asian
## 2    2017           Black 1000     310 0.3100000 0.6873333           Asian
## 3    2017        Hispanic 2000     410 0.2050000 0.6873333           Asian
## 4    2017 Multi-Ethnicity  500     262 0.5240000 0.6873333           Asian
## 5    2017 Native American  100      43 0.4300000 0.6873333           Asian
## 6    2017           White 3400    2053 0.6038235 0.6873333           Asian
## 7    2018           Asian 3000    2230 0.7433333 0.7433333           Asian
## 8    2018           Black 1000     297 0.2970000 0.7433333           Asian
## 9    2018        Hispanic 2000     437 0.2185000 0.7433333           Asian
## 10   2018 Multi-Ethnicity  500     242 0.4840000 0.7433333           Asian
## 11   2018 Native American  100      35 0.3500000 0.7433333           Asian
## 12   2018           White 3400    2147 0.6314706 0.7433333           Asian
##           moe    pct_lo    pct_hi di_indicator
## 1  0.03000000 0.6573333 0.7173333            0
## 2  0.03099032 0.2790097 0.3409903            1
## 3  0.03000000 0.1750000 0.2350000            1
## 4  0.04382693 0.4801731 0.5678269            1
## 5  0.09800000 0.3320000 0.5280000            1
## 6  0.03000000 0.5738235 0.6338235            1
## 7  0.03000000 0.7133333 0.7733333            0
## 8  0.03099032 0.2660097 0.3279903            1
## 9  0.03000000 0.1885000 0.2485000            1
## 10 0.04382693 0.4401731 0.5278269            1
## 11 0.09800000 0.2520000 0.4480000            1
## 12 0.03000000 0.6014706 0.6614706            1</code></pre>
<p>The user could also pass in custom reference points for comparison (eg, a state-wide rate). <code>di_ppg</code> accepts either a single reference point to be used or a vector of reference points, one for each cohort. For the latter, the vector of reference points will be taken to correspond to the <code>cohort</code> variable, alphabetically ordered.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1"><span class="co"># With custom reference (single)</span></a>
<a class="sourceLine" id="cb24-2" title="2"><span class="kw">di_ppg</span>(<span class="dt">success=</span>Transfer, <span class="dt">group=</span>Ethnicity, <span class="dt">reference=</span><span class="fl">0.54</span>, <span class="dt">data=</span>student_equity) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb24-3" title="3"><span class="st">  </span>as.data.frame</a></code></pre></div>
<pre><code>##             group    n success       pct reference reference_group
## 1           Asian 6000    4292 0.7153333      0.54         numeric
## 2           Black 2000     607 0.3035000      0.54         numeric
## 3        Hispanic 4000     847 0.2117500      0.54         numeric
## 4 Multi-Ethnicity 1000     504 0.5040000      0.54         numeric
## 5 Native American  200      78 0.3900000      0.54         numeric
## 6           White 6800    4200 0.6176471      0.54         numeric
##          moe    pct_lo    pct_hi di_indicator
## 1 0.03000000 0.6853333 0.7453333            0
## 2 0.03000000 0.2735000 0.3335000            1
## 3 0.03000000 0.1817500 0.2417500            1
## 4 0.03099032 0.4730097 0.5349903            1
## 5 0.06929646 0.3207035 0.4592965            1
## 6 0.03000000 0.5876471 0.6476471            0</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1"><span class="co"># With custom reference (multiple)</span></a>
<a class="sourceLine" id="cb26-2" title="2"><span class="kw">di_ppg</span>(<span class="dt">success=</span>Transfer, <span class="dt">group=</span>Ethnicity, <span class="dt">cohort=</span>Cohort, <span class="dt">reference=</span><span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">0.55</span>), <span class="dt">data=</span>student_equity) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb26-3" title="3"><span class="st">  </span>as.data.frame</a></code></pre></div>
<pre><code>##    cohort           group    n success       pct reference reference_group
## 1    2017           Asian 3000    2062 0.6873333      0.50         numeric
## 2    2017           Black 1000     310 0.3100000      0.50         numeric
## 3    2017        Hispanic 2000     410 0.2050000      0.50         numeric
## 4    2017 Multi-Ethnicity  500     262 0.5240000      0.50         numeric
## 5    2017 Native American  100      43 0.4300000      0.50         numeric
## 6    2017           White 3400    2053 0.6038235      0.50         numeric
## 7    2018           Asian 3000    2230 0.7433333      0.55         numeric
## 8    2018           Black 1000     297 0.2970000      0.55         numeric
## 9    2018        Hispanic 2000     437 0.2185000      0.55         numeric
## 10   2018 Multi-Ethnicity  500     242 0.4840000      0.55         numeric
## 11   2018 Native American  100      35 0.3500000      0.55         numeric
## 12   2018           White 3400    2147 0.6314706      0.55         numeric
##           moe    pct_lo    pct_hi di_indicator
## 1  0.03000000 0.6573333 0.7173333            0
## 2  0.03099032 0.2790097 0.3409903            1
## 3  0.03000000 0.1750000 0.2350000            1
## 4  0.04382693 0.4801731 0.5678269            0
## 5  0.09800000 0.3320000 0.5280000            0
## 6  0.03000000 0.5738235 0.6338235            0
## 7  0.03000000 0.7133333 0.7733333            0
## 8  0.03099032 0.2660097 0.3279903            1
## 9  0.03000000 0.1885000 0.2485000            1
## 10 0.04382693 0.4401731 0.5278269            1
## 11 0.09800000 0.2520000 0.4480000            1
## 12 0.03000000 0.6014706 0.6614706            0</code></pre>
<p>Disproportionate impact using the PPG relies on calculating the margine margin of error (MOE) pertaining around the success rate. The MOE calculated in <code>di_ppg</code> has 2 underlying assumptions (defaults):</p>
<ol style="list-style-type: decimal">
<li>the minimum MOE returned is 0.03, and</li>
<li>using 0.50 as the proportion in the margin of error formula, <span class="math inline">\(1.96 \times \sqrt{\hat{p} (1-\hat{p}) / n}\)</span>.</li>
</ol>
<p>To override 1, the user could specify <code>min_moe</code> in <code>di_ppg</code>. To override 2, the user could specify <code>use_prop_in_moe=TRUE</code> in <code>di_ppg</code>.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1"><span class="co"># min_moe</span></a>
<a class="sourceLine" id="cb28-2" title="2"><span class="kw">di_ppg</span>(<span class="dt">success=</span>Transfer, <span class="dt">group=</span>Ethnicity, <span class="dt">data=</span>student_equity, <span class="dt">min_moe=</span><span class="fl">0.02</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb28-3" title="3"><span class="st">  </span>as.data.frame</a></code></pre></div>
<pre><code>##             group    n success       pct reference reference_group
## 1           Asian 6000    4292 0.7153333    0.5264         overall
## 2           Black 2000     607 0.3035000    0.5264         overall
## 3        Hispanic 4000     847 0.2117500    0.5264         overall
## 4 Multi-Ethnicity 1000     504 0.5040000    0.5264         overall
## 5 Native American  200      78 0.3900000    0.5264         overall
## 6           White 6800    4200 0.6176471    0.5264         overall
##          moe    pct_lo    pct_hi di_indicator
## 1 0.02000000 0.6953333 0.7353333            0
## 2 0.02191347 0.2815865 0.3254135            1
## 3 0.02000000 0.1917500 0.2317500            1
## 4 0.03099032 0.4730097 0.5349903            0
## 5 0.06929646 0.3207035 0.4592965            1
## 6 0.02000000 0.5976471 0.6376471            0</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1"><span class="co"># use_prop_in_moe</span></a>
<a class="sourceLine" id="cb30-2" title="2"><span class="kw">di_ppg</span>(<span class="dt">success=</span>Transfer, <span class="dt">group=</span>Ethnicity, <span class="dt">data=</span>student_equity, <span class="dt">min_moe=</span><span class="fl">0.02</span>, <span class="dt">use_prop_in_moe=</span><span class="ot">TRUE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb30-3" title="3"><span class="st">  </span>as.data.frame</a></code></pre></div>
<pre><code>##             group    n success       pct reference reference_group
## 1           Asian 6000    4292 0.7153333    0.5264         overall
## 2           Black 2000     607 0.3035000    0.5264         overall
## 3        Hispanic 4000     847 0.2117500    0.5264         overall
## 4 Multi-Ethnicity 1000     504 0.5040000    0.5264         overall
## 5 Native American  200      78 0.3900000    0.5264         overall
## 6           White 6800    4200 0.6176471    0.5264         overall
##          moe    pct_lo    pct_hi di_indicator
## 1 0.02000000 0.6953333 0.7353333            0
## 2 0.02015028 0.2833497 0.3236503            1
## 3 0.02000000 0.1917500 0.2317500            1
## 4 0.03098933 0.4730107 0.5349893            0
## 5 0.06759869 0.3224013 0.4575987            1
## 6 0.02000000 0.5976471 0.6376471            0</code></pre>
<p>In cases where the proportion is used in calculating MOE, an observed proportion of 0 or 1 would lead to a zero MOE. To account for these scenarios, the user could leverage the <code>prop_sub_0</code> and <code>prop_sub_1</code> parameters in <code>di_ppg</code> and <code>ppg_moe</code> as substitutes. These parameters default to <code>0.5</code>, which maximizes the MOE (making it more difficult to declare disproportionate impact).</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" title="1"><span class="co"># Set Native American to have have zero transfers and see what the results</span></a>
<a class="sourceLine" id="cb32-2" title="2"><span class="kw">di_ppg</span>(<span class="dt">success=</span>Transfer, <span class="dt">group=</span>Ethnicity, <span class="dt">data=</span>student_equity <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">Transfer=</span><span class="kw">ifelse</span>(Ethnicity<span class="op">==</span><span class="st">&#39;Native American&#39;</span>, <span class="dv">0</span>, Transfer)), <span class="dt">use_prop_in_moe=</span><span class="ot">TRUE</span>, <span class="dt">prop_sub_0=</span><span class="fl">0.1</span>, <span class="dt">prop_sub_1=</span><span class="fl">0.9</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb32-3" title="3"><span class="st">  </span>as.data.frame</a></code></pre></div>
<pre><code>## Warning in ppg_moe(n = n, proportion = pct, min_moe = min_moe, prop_sub_0 =
## prop_sub_0, : The vector `proportion` contains 0. This will lead to a zero
## MOE. `prop_sub_0=0.1` will be used in calculating the MOE for these cases.</code></pre>
<pre><code>##             group    n success       pct reference reference_group
## 1           Asian 6000    4292 0.7153333    0.5225         overall
## 2           Black 2000     607 0.3035000    0.5225         overall
## 3        Hispanic 4000     847 0.2117500    0.5225         overall
## 4 Multi-Ethnicity 1000     504 0.5040000    0.5225         overall
## 5 Native American  200       0 0.0000000    0.5225         overall
## 6           White 6800    4200 0.6176471    0.5225         overall
##          moe      pct_lo     pct_hi di_indicator
## 1 0.03000000  0.68533333 0.74533333            0
## 2 0.03000000  0.27350000 0.33350000            1
## 3 0.03000000  0.18175000 0.24175000            1
## 4 0.03098933  0.47301067 0.53498933            0
## 5 0.04157788 -0.04157788 0.04157788            1
## 6 0.03000000  0.58764706 0.64764706            0</code></pre>
</div>
<div id="proportionality-index" class="section level2">
<h2>Proportionality index</h2>
<p><code>di_prop_index</code> is the main work function for this method, and it can take on vectors or column names the tidy way:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" title="1"><span class="co"># Without cohort</span></a>
<a class="sourceLine" id="cb35-2" title="2"><span class="co">## Vector</span></a>
<a class="sourceLine" id="cb35-3" title="3"><span class="kw">di_prop_index</span>(<span class="dt">success=</span>student_equity<span class="op">$</span>Transfer, <span class="dt">group=</span>student_equity<span class="op">$</span>Ethnicity) <span class="op">%&gt;%</span><span class="st"> </span>as.data.frame</a></code></pre></div>
<pre><code>##             group    n success pct_success pct_group di_prop_index
## 1           Asian 6000    4292 0.407674772      0.30     1.3589159
## 2           Black 2000     607 0.057655775      0.10     0.5765578
## 3        Hispanic 4000     847 0.080452128      0.20     0.4022606
## 4 Multi-Ethnicity 1000     504 0.047872340      0.05     0.9574468
## 5 Native American  200      78 0.007408815      0.01     0.7408815
## 6           White 6800    4200 0.398936170      0.34     1.1733417
##   di_indicator
## 1            0
## 2            1
## 3            1
## 4            0
## 5            1
## 6            0</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" title="1"><span class="co">## Tidy and column reference</span></a>
<a class="sourceLine" id="cb37-2" title="2"><span class="kw">di_prop_index</span>(<span class="dt">success=</span>Transfer, <span class="dt">group=</span>Ethnicity, <span class="dt">data=</span>student_equity) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-3" title="3"><span class="st">  </span>as.data.frame</a></code></pre></div>
<pre><code>##             group    n success pct_success pct_group di_prop_index
## 1           Asian 6000    4292 0.407674772      0.30     1.3589159
## 2           Black 2000     607 0.057655775      0.10     0.5765578
## 3        Hispanic 4000     847 0.080452128      0.20     0.4022606
## 4 Multi-Ethnicity 1000     504 0.047872340      0.05     0.9574468
## 5 Native American  200      78 0.007408815      0.01     0.7408815
## 6           White 6800    4200 0.398936170      0.34     1.1733417
##   di_indicator
## 1            0
## 2            1
## 3            1
## 4            0
## 5            1
## 6            0</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" title="1"><span class="co"># With cohort</span></a>
<a class="sourceLine" id="cb39-2" title="2"><span class="co">## Vector</span></a>
<a class="sourceLine" id="cb39-3" title="3"><span class="kw">di_prop_index</span>(<span class="dt">success=</span>student_equity<span class="op">$</span>Transfer, <span class="dt">group=</span>student_equity<span class="op">$</span>Ethnicity, <span class="dt">cohort=</span>student_equity<span class="op">$</span>Cohort) <span class="op">%&gt;%</span><span class="st"> </span>as.data.frame</a></code></pre></div>
<pre><code>##    cohort           group    n success pct_success pct_group di_prop_index
## 1    2017           Asian 3000    2062 0.401167315      0.30     1.3372244
## 2    2017           Black 1000     310 0.060311284      0.10     0.6031128
## 3    2017        Hispanic 2000     410 0.079766537      0.20     0.3988327
## 4    2017 Multi-Ethnicity  500     262 0.050972763      0.05     1.0194553
## 5    2017 Native American  100      43 0.008365759      0.01     0.8365759
## 6    2017           White 3400    2053 0.399416342      0.34     1.1747539
## 7    2018           Asian 3000    2230 0.413882702      0.30     1.3796090
## 8    2018           Black 1000     297 0.055122494      0.10     0.5512249
## 9    2018        Hispanic 2000     437 0.081106162      0.20     0.4055308
## 10   2018 Multi-Ethnicity  500     242 0.044914625      0.05     0.8982925
## 11   2018 Native American  100      35 0.006495917      0.01     0.6495917
## 12   2018           White 3400    2147 0.398478099      0.34     1.1719944
##    di_indicator
## 1             0
## 2             1
## 3             1
## 4             0
## 5             0
## 6             0
## 7             0
## 8             1
## 9             1
## 10            0
## 11            1
## 12            0</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" title="1"><span class="co">## Tidy and column reference</span></a>
<a class="sourceLine" id="cb41-2" title="2"><span class="kw">di_prop_index</span>(<span class="dt">success=</span>Transfer, <span class="dt">group=</span>Ethnicity, <span class="dt">cohort=</span>Cohort, <span class="dt">data=</span>student_equity) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb41-3" title="3"><span class="st">  </span>as.data.frame</a></code></pre></div>
<pre><code>##    cohort           group    n success pct_success pct_group di_prop_index
## 1    2017           Asian 3000    2062 0.401167315      0.30     1.3372244
## 2    2017           Black 1000     310 0.060311284      0.10     0.6031128
## 3    2017        Hispanic 2000     410 0.079766537      0.20     0.3988327
## 4    2017 Multi-Ethnicity  500     262 0.050972763      0.05     1.0194553
## 5    2017 Native American  100      43 0.008365759      0.01     0.8365759
## 6    2017           White 3400    2053 0.399416342      0.34     1.1747539
## 7    2018           Asian 3000    2230 0.413882702      0.30     1.3796090
## 8    2018           Black 1000     297 0.055122494      0.10     0.5512249
## 9    2018        Hispanic 2000     437 0.081106162      0.20     0.4055308
## 10   2018 Multi-Ethnicity  500     242 0.044914625      0.05     0.8982925
## 11   2018 Native American  100      35 0.006495917      0.01     0.6495917
## 12   2018           White 3400    2147 0.398478099      0.34     1.1719944
##    di_indicator
## 1             0
## 2             1
## 3             1
## 4             0
## 5             0
## 6             0
## 7             0
## 8             1
## 9             1
## 10            0
## 11            1
## 12            0</code></pre>
<p>Note that the referenced document describing this method does not recommend a threshold on the proportionality index for declaring disproportionate impact. The <code>di_prop_index</code> function uses <code>di_prop_index_cutoff=0.8</code> as the default threshold, which the user could change.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" title="1"><span class="co"># Changing threshold for DI</span></a>
<a class="sourceLine" id="cb43-2" title="2"><span class="kw">di_prop_index</span>(<span class="dt">success=</span>student_equity<span class="op">$</span>Transfer, <span class="dt">group=</span>student_equity<span class="op">$</span>Ethnicity, <span class="dt">cohort=</span>student_equity<span class="op">$</span>Cohort, <span class="dt">di_prop_index_cutoff=</span><span class="fl">0.5</span>) <span class="op">%&gt;%</span><span class="st"> </span>as.data.frame</a></code></pre></div>
<pre><code>##    cohort           group    n success pct_success pct_group di_prop_index
## 1    2017           Asian 3000    2062 0.401167315      0.30     1.3372244
## 2    2017           Black 1000     310 0.060311284      0.10     0.6031128
## 3    2017        Hispanic 2000     410 0.079766537      0.20     0.3988327
## 4    2017 Multi-Ethnicity  500     262 0.050972763      0.05     1.0194553
## 5    2017 Native American  100      43 0.008365759      0.01     0.8365759
## 6    2017           White 3400    2053 0.399416342      0.34     1.1747539
## 7    2018           Asian 3000    2230 0.413882702      0.30     1.3796090
## 8    2018           Black 1000     297 0.055122494      0.10     0.5512249
## 9    2018        Hispanic 2000     437 0.081106162      0.20     0.4055308
## 10   2018 Multi-Ethnicity  500     242 0.044914625      0.05     0.8982925
## 11   2018 Native American  100      35 0.006495917      0.01     0.6495917
## 12   2018           White 3400    2147 0.398478099      0.34     1.1719944
##    di_indicator
## 1             0
## 2             0
## 3             1
## 4             0
## 5             0
## 6             0
## 7             0
## 8             0
## 9             1
## 10            0
## 11            0
## 12            0</code></pre>
</div>
<div id="index" class="section level2">
<h2>80% index</h2>
<p><code>di_80_index</code> is the main work function for this method, and it can take on vectors or column names the tidy way:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" title="1"><span class="co"># Without cohort</span></a>
<a class="sourceLine" id="cb45-2" title="2"><span class="co">## Vector</span></a>
<a class="sourceLine" id="cb45-3" title="3"><span class="kw">di_80_index</span>(<span class="dt">success=</span>student_equity<span class="op">$</span>Transfer, <span class="dt">group=</span>student_equity<span class="op">$</span>Ethnicity) <span class="op">%&gt;%</span><span class="st"> </span>as.data.frame</a></code></pre></div>
<pre><code>##             group    n success       pct reference_group reference
## 1           Asian 6000    4292 0.7153333           Asian 0.7153333
## 2           Black 2000     607 0.3035000           Asian 0.7153333
## 3        Hispanic 4000     847 0.2117500           Asian 0.7153333
## 4 Multi-Ethnicity 1000     504 0.5040000           Asian 0.7153333
## 5 Native American  200      78 0.3900000           Asian 0.7153333
## 6           White 6800    4200 0.6176471           Asian 0.7153333
##   di_80_index di_indicator
## 1   1.0000000            0
## 2   0.4242777            1
## 3   0.2960158            1
## 4   0.7045666            1
## 5   0.5452004            1
## 6   0.8634395            0</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" title="1"><span class="co">## Tidy and column reference</span></a>
<a class="sourceLine" id="cb47-2" title="2"><span class="kw">di_80_index</span>(<span class="dt">success=</span>Transfer, <span class="dt">group=</span>Ethnicity, <span class="dt">data=</span>student_equity) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb47-3" title="3"><span class="st">  </span>as.data.frame</a></code></pre></div>
<pre><code>##             group    n success       pct reference_group reference
## 1           Asian 6000    4292 0.7153333           Asian 0.7153333
## 2           Black 2000     607 0.3035000           Asian 0.7153333
## 3        Hispanic 4000     847 0.2117500           Asian 0.7153333
## 4 Multi-Ethnicity 1000     504 0.5040000           Asian 0.7153333
## 5 Native American  200      78 0.3900000           Asian 0.7153333
## 6           White 6800    4200 0.6176471           Asian 0.7153333
##   di_80_index di_indicator
## 1   1.0000000            0
## 2   0.4242777            1
## 3   0.2960158            1
## 4   0.7045666            1
## 5   0.5452004            1
## 6   0.8634395            0</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" title="1"><span class="co"># With cohort</span></a>
<a class="sourceLine" id="cb49-2" title="2"><span class="co">## Vector</span></a>
<a class="sourceLine" id="cb49-3" title="3"><span class="kw">di_80_index</span>(<span class="dt">success=</span>student_equity<span class="op">$</span>Transfer, <span class="dt">group=</span>student_equity<span class="op">$</span>Ethnicity, <span class="dt">cohort=</span>student_equity<span class="op">$</span>Cohort) <span class="op">%&gt;%</span><span class="st"> </span>as.data.frame</a></code></pre></div>
<pre><code>##    cohort           group    n success       pct reference_group reference
## 1    2017           Asian 3000    2062 0.6873333           Asian 0.6873333
## 2    2017           Black 1000     310 0.3100000           Asian 0.6873333
## 3    2017        Hispanic 2000     410 0.2050000           Asian 0.6873333
## 4    2017 Multi-Ethnicity  500     262 0.5240000           Asian 0.6873333
## 5    2017 Native American  100      43 0.4300000           Asian 0.6873333
## 6    2017           White 3400    2053 0.6038235           Asian 0.6873333
## 7    2018           Asian 3000    2230 0.7433333           Asian 0.7433333
## 8    2018           Black 1000     297 0.2970000           Asian 0.7433333
## 9    2018        Hispanic 2000     437 0.2185000           Asian 0.7433333
## 10   2018 Multi-Ethnicity  500     242 0.4840000           Asian 0.7433333
## 11   2018 Native American  100      35 0.3500000           Asian 0.7433333
## 12   2018           White 3400    2147 0.6314706           Asian 0.7433333
##    di_80_index di_indicator
## 1    1.0000000            0
## 2    0.4510184            1
## 3    0.2982541            1
## 4    0.7623666            1
## 5    0.6256062            1
## 6    0.8785017            0
## 7    1.0000000            0
## 8    0.3995516            1
## 9    0.2939462            1
## 10   0.6511211            1
## 11   0.4708520            1
## 12   0.8495120            0</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" title="1"><span class="co">## Tidy and column reference</span></a>
<a class="sourceLine" id="cb51-2" title="2"><span class="kw">di_80_index</span>(<span class="dt">success=</span>Transfer, <span class="dt">group=</span>Ethnicity, <span class="dt">cohort=</span>Cohort, <span class="dt">data=</span>student_equity) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb51-3" title="3"><span class="st">  </span>as.data.frame</a></code></pre></div>
<pre><code>##    cohort           group    n success       pct reference_group reference
## 1    2017           Asian 3000    2062 0.6873333           Asian 0.6873333
## 2    2017           Black 1000     310 0.3100000           Asian 0.6873333
## 3    2017        Hispanic 2000     410 0.2050000           Asian 0.6873333
## 4    2017 Multi-Ethnicity  500     262 0.5240000           Asian 0.6873333
## 5    2017 Native American  100      43 0.4300000           Asian 0.6873333
## 6    2017           White 3400    2053 0.6038235           Asian 0.6873333
## 7    2018           Asian 3000    2230 0.7433333           Asian 0.7433333
## 8    2018           Black 1000     297 0.2970000           Asian 0.7433333
## 9    2018        Hispanic 2000     437 0.2185000           Asian 0.7433333
## 10   2018 Multi-Ethnicity  500     242 0.4840000           Asian 0.7433333
## 11   2018 Native American  100      35 0.3500000           Asian 0.7433333
## 12   2018           White 3400    2147 0.6314706           Asian 0.7433333
##    di_80_index di_indicator
## 1    1.0000000            0
## 2    0.4510184            1
## 3    0.2982541            1
## 4    0.7623666            1
## 5    0.6256062            1
## 6    0.8785017            0
## 7    1.0000000            0
## 8    0.3995516            1
## 9    0.2939462            1
## 10   0.6511211            1
## 11   0.4708520            1
## 12   0.8495120            0</code></pre>
<p>By default, <code>di_80_index</code> uses the group with the highest success rate as reference in calculating the index. One could specify the the comparison group using the <code>reference_group</code> argument (a value from <code>group</code>).</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" title="1"><span class="co"># Changing reference group</span></a>
<a class="sourceLine" id="cb53-2" title="2"><span class="kw">di_80_index</span>(<span class="dt">success=</span>student_equity<span class="op">$</span>Transfer, <span class="dt">group=</span>student_equity<span class="op">$</span>Ethnicity, <span class="dt">cohort=</span>student_equity<span class="op">$</span>Cohort, <span class="dt">reference_group=</span><span class="st">&#39;White&#39;</span>) <span class="op">%&gt;%</span><span class="st"> </span>as.data.frame</a></code></pre></div>
<pre><code>##    cohort           group    n success       pct reference_group reference
## 1    2017           Asian 3000    2062 0.6873333           White 0.6038235
## 2    2017           Black 1000     310 0.3100000           White 0.6038235
## 3    2017        Hispanic 2000     410 0.2050000           White 0.6038235
## 4    2017 Multi-Ethnicity  500     262 0.5240000           White 0.6038235
## 5    2017 Native American  100      43 0.4300000           White 0.6038235
## 6    2017           White 3400    2053 0.6038235           White 0.6038235
## 7    2018           Asian 3000    2230 0.7433333           White 0.6314706
## 8    2018           Black 1000     297 0.2970000           White 0.6314706
## 9    2018        Hispanic 2000     437 0.2185000           White 0.6314706
## 10   2018 Multi-Ethnicity  500     242 0.4840000           White 0.6314706
## 11   2018 Native American  100      35 0.3500000           White 0.6314706
## 12   2018           White 3400    2147 0.6314706           White 0.6314706
##    di_80_index di_indicator
## 1    1.1383017            0
## 2    0.5133950            1
## 3    0.3395032            1
## 4    0.8678032            0
## 5    0.7121286            1
## 6    1.0000000            0
## 7    1.1771464            0
## 8    0.4703307            1
## 9    0.3460177            1
## 10   0.7664648            1
## 11   0.5542618            1
## 12   1.0000000            0</code></pre>
<p>By default, <code>di_80_index</code> uses 80% (<code>di_80_index_cutoff=0.80</code>) as the default threshold for declaring disproportionate impact. One could override this using another threshold via the <code>di_80_index_cutoff</code> argument.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" title="1"><span class="co"># Changing threshold for DI</span></a>
<a class="sourceLine" id="cb55-2" title="2"><span class="kw">di_80_index</span>(<span class="dt">success=</span>student_equity<span class="op">$</span>Transfer, <span class="dt">group=</span>student_equity<span class="op">$</span>Ethnicity, <span class="dt">cohort=</span>student_equity<span class="op">$</span>Cohort, <span class="dt">di_80_index_cutoff=</span><span class="fl">0.50</span>) <span class="op">%&gt;%</span><span class="st"> </span>as.data.frame</a></code></pre></div>
<pre><code>##    cohort           group    n success       pct reference_group reference
## 1    2017           Asian 3000    2062 0.6873333           Asian 0.6873333
## 2    2017           Black 1000     310 0.3100000           Asian 0.6873333
## 3    2017        Hispanic 2000     410 0.2050000           Asian 0.6873333
## 4    2017 Multi-Ethnicity  500     262 0.5240000           Asian 0.6873333
## 5    2017 Native American  100      43 0.4300000           Asian 0.6873333
## 6    2017           White 3400    2053 0.6038235           Asian 0.6873333
## 7    2018           Asian 3000    2230 0.7433333           Asian 0.7433333
## 8    2018           Black 1000     297 0.2970000           Asian 0.7433333
## 9    2018        Hispanic 2000     437 0.2185000           Asian 0.7433333
## 10   2018 Multi-Ethnicity  500     242 0.4840000           Asian 0.7433333
## 11   2018 Native American  100      35 0.3500000           Asian 0.7433333
## 12   2018           White 3400    2147 0.6314706           Asian 0.7433333
##    di_80_index di_indicator
## 1    1.0000000            0
## 2    0.4510184            1
## 3    0.2982541            1
## 4    0.7623666            0
## 5    0.6256062            0
## 6    0.8785017            0
## 7    1.0000000            0
## 8    0.3995516            1
## 9    0.2939462            1
## 10   0.6511211            0
## 11   0.4708520            1
## 12   0.8495120            0</code></pre>
</div>
<div id="when-dealing-with-a-non-success-variable-like-drop-out-or-probation" class="section level2">
<h2>When dealing with a non-success variable like drop-out or probation</h2>
<p>All methods and functions implemented in the <code>DisImpact</code> package treat outcomes as positive: 1 is desired over 0 (higher rate is better, lower rate indicates disparity). The choice of the name <code>success</code> in the functions’ arguments is intentional to remind the user of this.</p>
<p>Suppose we have a variable that indicates something negative (eg, a flag for students on academic probation). We could calculate DI on the converse of it by using the <code>!</code> (logical negation) operator:</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" title="1"><span class="co">## di_ppg(success=!Probation, group=Ethnicity, data=student_equity) %&gt;%</span></a>
<a class="sourceLine" id="cb57-2" title="2"><span class="co">##   as.data.frame ## If there were a Probation variable</span></a>
<a class="sourceLine" id="cb57-3" title="3"><span class="kw">di_ppg</span>(<span class="dt">success=</span><span class="op">!</span>Transfer, <span class="dt">group=</span>Ethnicity, <span class="dt">data=</span>student_equity) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb57-4" title="4"><span class="st">  </span>as.data.frame <span class="co">## Illustrating the point with `!`</span></a></code></pre></div>
<pre><code>##             group    n success       pct reference reference_group
## 1           Asian 6000    1708 0.2846667    0.4736         overall
## 2           Black 2000    1393 0.6965000    0.4736         overall
## 3        Hispanic 4000    3153 0.7882500    0.4736         overall
## 4 Multi-Ethnicity 1000     496 0.4960000    0.4736         overall
## 5 Native American  200     122 0.6100000    0.4736         overall
## 6           White 6800    2600 0.3823529    0.4736         overall
##          moe    pct_lo    pct_hi di_indicator
## 1 0.03000000 0.2546667 0.3146667            1
## 2 0.03000000 0.6665000 0.7265000            0
## 3 0.03000000 0.7582500 0.8182500            0
## 4 0.03099032 0.4650097 0.5269903            0
## 5 0.06929646 0.5407035 0.6792965            0
## 6 0.03000000 0.3523529 0.4123529            1</code></pre>
</div>
<div id="transformations-on-the-fly" class="section level2">
<h2>Transformations on the fly</h2>
<p>We can compute the success, group, and cohort variables on the fly:</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" title="1"><span class="co"># Transform success</span></a>
<a class="sourceLine" id="cb59-2" title="2">a &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">1</span>, <span class="dt">size=</span><span class="kw">nrow</span>(student_equity), <span class="dt">replace=</span><span class="ot">TRUE</span>, <span class="dt">prob=</span><span class="kw">c</span>(<span class="fl">0.95</span>, <span class="fl">0.05</span>))</a>
<a class="sourceLine" id="cb59-3" title="3"><span class="kw">mean</span>(a)</a></code></pre></div>
<pre><code>## [1] 0.0498</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" title="1"><span class="kw">di_ppg</span>(<span class="dt">success=</span><span class="kw">pmax</span>(Transfer, a), <span class="dt">group=</span>Ethnicity, <span class="dt">data=</span>student_equity) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb61-2" title="2"><span class="st">  </span>as.data.frame</a></code></pre></div>
<pre><code>##             group    n success       pct reference reference_group
## 1           Asian 6000    4380 0.7300000    0.5504         overall
## 2           Black 2000     677 0.3385000    0.5504         overall
## 3        Hispanic 4000    1020 0.2550000    0.5504         overall
## 4 Multi-Ethnicity 1000     530 0.5300000    0.5504         overall
## 5 Native American  200      85 0.4250000    0.5504         overall
## 6           White 6800    4316 0.6347059    0.5504         overall
##          moe    pct_lo    pct_hi di_indicator
## 1 0.03000000 0.7000000 0.7600000            0
## 2 0.03000000 0.3085000 0.3685000            1
## 3 0.03000000 0.2250000 0.2850000            1
## 4 0.03099032 0.4990097 0.5609903            0
## 5 0.06929646 0.3557035 0.4942965            1
## 6 0.03000000 0.6047059 0.6647059            0</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" title="1"><span class="co"># Collapse Black and Hispanic</span></a>
<a class="sourceLine" id="cb63-2" title="2"><span class="kw">di_ppg</span>(<span class="dt">success=</span>Transfer, <span class="dt">group=</span><span class="kw">ifelse</span>(Ethnicity <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;Black&#39;</span>, <span class="st">&#39;Hispanic&#39;</span>), <span class="st">&#39;Black/Hispanic&#39;</span>, Ethnicity), <span class="dt">data=</span>student_equity) <span class="op">%&gt;%</span><span class="st"> </span>as.data.frame</a></code></pre></div>
<pre><code>##             group    n success       pct reference reference_group
## 1           Asian 6000    4292 0.7153333    0.5264         overall
## 2  Black/Hispanic 6000    1454 0.2423333    0.5264         overall
## 3 Multi-Ethnicity 1000     504 0.5040000    0.5264         overall
## 4 Native American  200      78 0.3900000    0.5264         overall
## 5           White 6800    4200 0.6176471    0.5264         overall
##          moe    pct_lo    pct_hi di_indicator
## 1 0.03000000 0.6853333 0.7453333            0
## 2 0.03000000 0.2123333 0.2723333            1
## 3 0.03099032 0.4730097 0.5349903            0
## 4 0.06929646 0.3207035 0.4592965            1
## 5 0.03000000 0.5876471 0.6476471            0</code></pre>
</div>
<div id="calculate-di-for-many-variables-and-groups" class="section level2">
<h2>Calculate DI for many variables and groups</h2>
<p>It is often the case that the user desires to calculate disproportionate impact across many outcome variables and many disaggregation/group variables. The function <code>di_iterate</code> allows the user to specify a data set and the various variables to iterate across:</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb65-1" title="1"><span class="co"># Multiple group variables</span></a>
<a class="sourceLine" id="cb65-2" title="2"><span class="kw">di_iterate</span>(<span class="dt">data=</span>student_equity, <span class="dt">success_vars=</span><span class="kw">c</span>(<span class="st">&#39;Transfer&#39;</span>), <span class="dt">group_vars=</span><span class="kw">c</span>(<span class="st">&#39;Ethnicity&#39;</span>, <span class="st">&#39;Gender&#39;</span>), <span class="dt">cohort_vars=</span><span class="kw">c</span>(<span class="st">&#39;Cohort&#39;</span>), <span class="dt">ppg_reference_groups=</span><span class="st">&#39;overall&#39;</span>) <span class="op">%&gt;%</span><span class="st"> </span>as.data.frame</a></code></pre></div>
<pre><code>##    success_variable cohort_variable cohort disaggregation           group
## 1          Transfer          Cohort   2017      Ethnicity           Asian
## 2          Transfer          Cohort   2017      Ethnicity           Black
## 3          Transfer          Cohort   2017      Ethnicity        Hispanic
## 4          Transfer          Cohort   2017      Ethnicity Multi-Ethnicity
## 5          Transfer          Cohort   2017      Ethnicity Native American
## 6          Transfer          Cohort   2017      Ethnicity           White
## 7          Transfer          Cohort   2018      Ethnicity           Asian
## 8          Transfer          Cohort   2018      Ethnicity           Black
## 9          Transfer          Cohort   2018      Ethnicity        Hispanic
## 10         Transfer          Cohort   2018      Ethnicity Multi-Ethnicity
## 11         Transfer          Cohort   2018      Ethnicity Native American
## 12         Transfer          Cohort   2018      Ethnicity           White
## 13         Transfer          Cohort   2017         Gender          Female
## 14         Transfer          Cohort   2017         Gender            Male
## 15         Transfer          Cohort   2017         Gender           Other
## 16         Transfer          Cohort   2018         Gender          Female
## 17         Transfer          Cohort   2018         Gender            Male
## 18         Transfer          Cohort   2018         Gender           Other
## 19         Transfer          Cohort   2017         - None           - All
## 20         Transfer          Cohort   2018         - None           - All
##        n success       pct ppg_reference ppg_reference_group        moe
## 1   3000    2062 0.6873333        0.5140             overall 0.03000000
## 2   1000     310 0.3100000        0.5140             overall 0.03099032
## 3   2000     410 0.2050000        0.5140             overall 0.03000000
## 4    500     262 0.5240000        0.5140             overall 0.04382693
## 5    100      43 0.4300000        0.5140             overall 0.09800000
## 6   3400    2053 0.6038235        0.5140             overall 0.03000000
## 7   3000    2230 0.7433333        0.5388             overall 0.03000000
## 8   1000     297 0.2970000        0.5388             overall 0.03099032
## 9   2000     437 0.2185000        0.5388             overall 0.03000000
## 10   500     242 0.4840000        0.5388             overall 0.04382693
## 11   100      35 0.3500000        0.5388             overall 0.09800000
## 12  3400    2147 0.6314706        0.5388             overall 0.03000000
## 13  4930    2513 0.5097363        0.5140             overall 0.03000000
## 14  4886    2548 0.5214900        0.5140             overall 0.03000000
## 15   184      79 0.4293478        0.5140             overall 0.07224656
## 16  4928    2638 0.5353084        0.5388             overall 0.03000000
## 17  4880    2642 0.5413934        0.5388             overall 0.03000000
## 18   192     108 0.5625000        0.5388             overall 0.07072541
## 19 10000    5140 0.5140000        0.5140             overall 0.03000000
## 20 10000    5388 0.5388000        0.5388             overall 0.03000000
##       pct_lo    pct_hi di_indicator_ppg di_prop_index
## 1  0.6573333 0.7173333                0     1.3372244
## 2  0.2790097 0.3409903                1     0.6031128
## 3  0.1750000 0.2350000                1     0.3988327
## 4  0.4801731 0.5678269                0     1.0194553
## 5  0.3320000 0.5280000                0     0.8365759
## 6  0.5738235 0.6338235                0     1.1747539
## 7  0.7133333 0.7733333                0     1.3796090
## 8  0.2660097 0.3279903                1     0.5512249
## 9  0.1885000 0.2485000                1     0.4055308
## 10 0.4401731 0.5278269                1     0.8982925
## 11 0.2520000 0.4480000                1     0.6495917
## 12 0.6014706 0.6614706                0     1.1719944
## 13 0.4797363 0.5397363                0     0.9917049
## 14 0.4914900 0.5514900                0     1.0145719
## 15 0.3571013 0.5015944                1     0.8353071
## 16 0.5053084 0.5653084                0     0.9935198
## 17 0.5113934 0.5713934                0     1.0048134
## 18 0.4917746 0.6332254                0     1.0439866
## 19 0.4840000 0.5440000                0     1.0000000
## 20 0.5088000 0.5688000                0     1.0000000
##    di_indicator_prop_index di_80_index_reference_group di_80_index
## 1                        0                       Asian   1.0000000
## 2                        1                       Asian   0.4510184
## 3                        1                       Asian   0.2982541
## 4                        0                       Asian   0.7623666
## 5                        0                       Asian   0.6256062
## 6                        0                       Asian   0.8785017
## 7                        0                       Asian   1.0000000
## 8                        1                       Asian   0.3995516
## 9                        1                       Asian   0.2939462
## 10                       0                       Asian   0.6511211
## 11                       1                       Asian   0.4708520
## 12                       0                       Asian   0.8495120
## 13                       0                        Male   0.9774614
## 14                       0                        Male   1.0000000
## 15                       0                        Male   0.8233098
## 16                       0                       Other   0.9516595
## 17                       0                       Other   0.9624772
## 18                       0                       Other   1.0000000
## 19                       0                       - All   1.0000000
## 20                       0                       - All   1.0000000
##    di_indicator_80_index
## 1                      0
## 2                      1
## 3                      1
## 4                      1
## 5                      1
## 6                      0
## 7                      0
## 8                      1
## 9                      1
## 10                     1
## 11                     1
## 12                     0
## 13                     0
## 14                     0
## 15                     0
## 16                     0
## 17                     0
## 18                     0
## 19                     0
## 20                     0</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb67-1" title="1"><span class="co"># Multiple group variables and different reference groups</span></a>
<a class="sourceLine" id="cb67-2" title="2"></a>
<a class="sourceLine" id="cb67-3" title="3"><span class="kw">bind_rows</span>(</a>
<a class="sourceLine" id="cb67-4" title="4">  <span class="kw">di_iterate</span>(<span class="dt">data=</span>student_equity, <span class="dt">success_vars=</span><span class="kw">c</span>(<span class="st">&#39;Transfer&#39;</span>), <span class="dt">group_vars=</span><span class="kw">c</span>(<span class="st">&#39;Ethnicity&#39;</span>, <span class="st">&#39;Gender&#39;</span>), <span class="dt">cohort_vars=</span><span class="kw">c</span>(<span class="st">&#39;Cohort&#39;</span>), <span class="dt">ppg_reference_groups=</span><span class="st">&#39;overall&#39;</span>)</a>
<a class="sourceLine" id="cb67-5" title="5">  , <span class="kw">di_iterate</span>(<span class="dt">data=</span>student_equity, <span class="dt">success_vars=</span><span class="kw">c</span>(<span class="st">&#39;Transfer&#39;</span>), <span class="dt">group_vars=</span><span class="kw">c</span>(<span class="st">&#39;Ethnicity&#39;</span>, <span class="st">&#39;Gender&#39;</span>), <span class="dt">cohort_vars=</span><span class="kw">c</span>(<span class="st">&#39;Cohort&#39;</span>), <span class="dt">ppg_reference_groups=</span><span class="kw">c</span>(<span class="st">&#39;White&#39;</span>, <span class="st">&#39;Male&#39;</span>), <span class="dt">include_non_disagg_results=</span><span class="ot">FALSE</span>) <span class="co"># include_non_disagg_results = FALSE: Already have this scenario in Overall run</span></a>
<a class="sourceLine" id="cb67-6" title="6">)</a></code></pre></div>
<pre><code>## # A tibble: 38 x 19
##    success_variable cohort_variable cohort disaggregation group     n
##    &lt;chr&gt;            &lt;chr&gt;            &lt;int&gt; &lt;chr&gt;          &lt;chr&gt; &lt;dbl&gt;
##  1 Transfer         Cohort            2017 Ethnicity      Asian  3000
##  2 Transfer         Cohort            2017 Ethnicity      Black  1000
##  3 Transfer         Cohort            2017 Ethnicity      Hisp~  2000
##  4 Transfer         Cohort            2017 Ethnicity      Mult~   500
##  5 Transfer         Cohort            2017 Ethnicity      Nati~   100
##  6 Transfer         Cohort            2017 Ethnicity      White  3400
##  7 Transfer         Cohort            2018 Ethnicity      Asian  3000
##  8 Transfer         Cohort            2018 Ethnicity      Black  1000
##  9 Transfer         Cohort            2018 Ethnicity      Hisp~  2000
## 10 Transfer         Cohort            2018 Ethnicity      Mult~   500
## # ... with 28 more rows, and 13 more variables: success &lt;int&gt;, pct &lt;dbl&gt;,
## #   ppg_reference &lt;dbl&gt;, ppg_reference_group &lt;chr&gt;, moe &lt;dbl&gt;,
## #   pct_lo &lt;dbl&gt;, pct_hi &lt;dbl&gt;, di_indicator_ppg &lt;dbl&gt;,
## #   di_prop_index &lt;dbl&gt;, di_indicator_prop_index &lt;dbl&gt;,
## #   di_80_index_reference_group &lt;chr&gt;, di_80_index &lt;dbl&gt;,
## #   di_indicator_80_index &lt;dbl&gt;</code></pre>
<p>There is a separate vignette that explains how one might leverage <code>di_iterate</code> for rapid dashboard development and deployment.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
